---
Status: Ready for Review
Epic: Epic 2: Prediction Model & Core Dashboard
Story: Story 2.7
Title: Basic Automated Betting Suggestion
---

As a **User**,
I want to **receive basic betting suggestions based on model predictions and scraped odds**,
so that **I can identify potential value bets for upcoming matches.**

### Acceptance Criteria

1.  The `scraper.py` (or an extended version) is capable of fetching future betting odds for upcoming matches from at least one source (e.g., football-data.co.uk CSVs, or a basic Playwright scrape if feasible for future odds).
2.  A new table, `future_odds`, is created in `football.db` to store the scraped future betting odds.
3.  A new function or script is implemented that:
    *   Loads the trained ML model.
    *   Retrieves upcoming match data and their corresponding future odds from the `future_odds` table.
    *   Compares the model's predicted probabilities with the implied probabilities from the scraped odds.
    *   Identifies and suggests bets where the model's predicted probability for an outcome is significantly higher (e.g., 5% or more) than the implied probability from the odds.
4.  The betting suggestions are displayed in a clear format (e.g., printed to console, or integrated into the Streamlit dashboard if simple).
5.  The `requirements.txt` is updated with any new dependencies.

### Dev Notes

*   **Data Sources**: Prioritize using existing `football-data.co.uk` CSVs for future odds if available, as they are simpler than dynamic scraping. If not, a basic Playwright scrape for future odds from a single, stable source could be considered.
*   **Logic**: The "significant difference" threshold (e.g., 5%) can be a configurable parameter.
*   **Output**: For MVP, printing suggestions to the console is acceptable. Integration into Streamlit can be a follow-up task if complexity allows.
*   **`future_odds` table schema**: Should include columns like `MatchID` (or `Date`, `HomeTeam`, `AwayTeam` for composite key), `Bookmaker`, `HomeOdds`, `DrawOdds`, `AwayOdds`, and potentially a timestamp for when the odds were scraped.

### Tasks / Subtasks

- [ ] Enhance `scraper.py` to fetch future betting odds.
- [ ] Implement logic to create and populate the `future_odds` table in `football.db` with scraped data.
- [ ] Create a new script (e.g., `betting_advisor.py`) or function to implement the betting suggestion logic.
- [ ] Load model and retrieve upcoming matches and their odds from `future_odds` table.
- [ ] Calculate implied probabilities from scraped odds.
- [ ] Compare model probabilities with implied odds and identify value bets.
- [ ] Display the betting suggestions.
- [ ] Update `requirements.txt`.

### Dev Agent Record

#### Agent Model Used:

#### Debug Log References:

#### Completion Notes List:

#### File List:

#### Change Log:

### QA Results

**Final Story Validation Report for Story 2.7: Basic Automated Betting Suggestion**

**Quick Summary:**
- Story readiness: READY
- Clarity score: 9/10
- Major gaps identified: None

**Category Statuses:**

| Category                             | Status | Issues |
| :----------------------------------- | :----- | :----- |
| 1. Goal & Context Clarity            | PASS   |        |
| 2. Technical Implementation Guidance | PASS   |        |
| 3. Reference Effectiveness           | PASS   |        |
| 4. Self-Containment Assessment       | PASS   |        |
| 5. Testing Guidance                  | PASS   |        |

**Specific Issues (if any):**
- None. The story is well-defined and provides sufficient context for implementation.

**Developer Perspective:**
- Could YOU implement this story as written? Yes.
- What questions would you have? None, the story is clear.
- What might cause delays or rework? The availability and consistency of future odds data from external sources.

**Final Assessment:**
- **READY**: The story provides sufficient context for implementation.
